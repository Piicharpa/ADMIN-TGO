"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[385],{2494:function(e,t,a){var o=a(9268);a(6006);var n=a(4390),i=a(3702);t.Z=e=>{let{visible:t,onHide:a,onConfirm:l,message:s}=e,r=(0,o.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,o.jsx)(i.z,{label:"ไม่",icon:"pi pi-times",outlined:!0,onClick:a}),(0,o.jsx)(i.z,{label:"ใช่",icon:"pi pi-check",severity:"danger",onClick:l})]});return(0,o.jsx)(n.V,{visible:t,style:{width:"450px"},header:"ยืนยันการลบ",modal:!0,footer:r,onHide:a,children:(0,o.jsxs)("div",{className:"flex align-items-center justify-content-center",children:[(0,o.jsx)("i",{className:"pi pi-exclamation-triangle mr-3",style:{fontSize:"2rem",color:"var(--red-500)"}}),(0,o.jsx)("span",{children:s})]})})}},1385:function(e,t,a){a.r(t),a.d(t,{default:function(){return x}});var o=a(9268),n=a(3702),i=a(8298),l=a(8176),s=a(315),r=a(8958),c=a(4390),d=a(4631),u=a(5942),f=a(3612),p=a(6006);function m(e){let{visible:t,ef:a,submitted:i,onHide:l,onChange:r,onSave:p,tgoCategories:m,tgoSubcategories:h,onCategoryChange:_,onSubcategoryChange:g}=e,y=(0,o.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,o.jsx)(n.z,{label:"ยกเลิก",icon:"pi pi-times",outlined:!0,onClick:l}),(0,o.jsx)(n.z,{label:"บันทึก",icon:"pi pi-check",onClick:p})]}),v=a.tgo_ef_cat_id?null==h?void 0:h.filter(e=>e.tgo_ef_cat_id===a.tgo_ef_cat_id):[];return(0,o.jsxs)(c.V,{visible:t,style:{width:"500px"},header:"รายละเอียด EF",modal:!0,className:"p-fluid",footer:y,onHide:l,children:[(0,o.jsxs)("div",{className:"field mt-3",children:[(0,o.jsx)("label",{htmlFor:"item",className:"font-bold",children:"รายการ *"}),(0,o.jsx)(s.o,{id:"item",value:a.item,onChange:e=>r(e,"item"),required:!0,autoFocus:!0,className:(0,u.AK)({"p-invalid":i&&!a.item}),placeholder:"กรอกรายการ"}),i&&!a.item&&(0,o.jsx)("small",{className:"p-error",children:"จำเป็นต้องกรอกรายการ"})]}),(0,o.jsxs)("div",{className:"field mt-3",children:[(0,o.jsx)("label",{htmlFor:"item_detail",className:"font-bold",children:"รายละเอียด"}),(0,o.jsx)(d.g,{id:"item_detail",value:a.item_detail,onChange:e=>r(e,"item_detail"),rows:3,placeholder:"กรอกรายละเอียด"})]}),(0,o.jsxs)("div",{className:"field mt-3",children:[(0,o.jsx)("label",{htmlFor:"unit",className:"font-bold",children:"หน่วย"}),(0,o.jsx)(s.o,{id:"unit",value:a.unit,onChange:e=>r(e,"unit"),placeholder:"กรอกหน่วย"})]}),(0,o.jsxs)("div",{className:"field mt-3",children:[(0,o.jsx)("label",{htmlFor:"ef",className:"font-bold",children:"ค่า EF"}),(0,o.jsx)(s.o,{id:"ef",value:a.ef,onChange:e=>r(e,"ef"),placeholder:"กรอกค่า EF"})]}),(0,o.jsxs)("div",{className:"field mt-3",children:[(0,o.jsx)("label",{htmlFor:"ef_source_ref",className:"font-bold",children:"ที่มา"}),(0,o.jsx)(s.o,{id:"ef_source_ref",value:a.ef_source_ref,onChange:e=>r(e,"ef_source_ref"),placeholder:"กรอกที่มา"})]}),(0,o.jsxs)("div",{className:"field mt-3",children:[(0,o.jsx)("label",{htmlFor:"tgo_updated",className:"font-bold",children:"TGO Updated"}),(0,o.jsx)(s.o,{id:"tgo_updated",value:a.tgo_updated||"",onChange:e=>r(e,"tgo_updated"),placeholder:"กรอกข้อมูล TGO Updated"})]}),(0,o.jsxs)("div",{className:"field mt-3",children:[(0,o.jsx)("label",{htmlFor:"tgo_ef_cat_name",className:"font-bold",children:"หมวดหมู่หลัก"}),(0,o.jsx)(f.L,{id:"tgo_ef_cat_name",value:a.tgo_ef_cat_id,options:m,onChange:_,optionLabel:"tgo_ef_cat_name",optionValue:"tgo_ef_cat_id",placeholder:"เลือกหมวดหมู่หลัก"})]}),(0,o.jsxs)("div",{className:"field mt-3",children:[(0,o.jsx)("label",{htmlFor:"tgo_ef_subcat_name",className:"font-bold",children:"หมวดหมู่ย่อย"}),(0,o.jsx)(f.L,{id:"tgo_ef_subcat_name",value:a.tgo_ef_subcat_id||null,options:v,onChange:g,optionLabel:"tgo_ef_subcat_name",optionValue:"tgo_ef_subcat_id",placeholder:"เลือกหมวดหมู่ย่อย",disabled:!a.tgo_ef_cat_id})]})]})}var h=a(2494);let _="http://178.128.123.212:5000/api/v1/admin";function g(e){return{ef_id:e.ef_id,item:e.item,item_detail:e.item_detail,unit:e.unit,ef:e.ef,ef_source_ref:e.ef_source_ref,tgo_updated:e.tgo_updated,tgo_ef_subcat_id:e.tgo_ef_subcat_id,created_date:e.created_date,updated_date:e.updated_date,tgo_ef_cat_name:e.tgo_ef_cat_name,tgo_ef_subcat_name:e.tgo_ef_subcat_name,tgo_ef_cat_id:e.tgo_ef_cat_id}}function y(e){return{tgo_ef_cat_id:e.tgo_ef_cat_id,tgo_ef_cat_name:e.tgo_ef_cat_name,created_date:e.created_date,updated_date:e.updated_date}}function v(e){return{tgo_ef_subcat_id:e.tgo_ef_subcat_id,tgo_ef_subcat_name:e.tgo_ef_subcat_name,tgo_ef_cat_id:e.tgo_ef_cat_id,created_date:e.created_date,updated_date:e.updated_date}}let b={getEfs:()=>fetch("".concat(_,"/tgoef"),{headers:{"Cache-Control":"no-cache"}}).then(e=>e.ok?e.json():Promise.reject(e)).then(e=>e.map(g)),getEfById:e=>fetch("".concat(_,"/tgoef/").concat(e),{headers:{"Cache-Control":"no-cache"}}).then(e=>e.ok?e.json():Promise.reject(e)).then(g),createEf:e=>fetch("".concat(_,"/tgoef"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.ok?e.json():Promise.reject(e)).then(g),updateEf:e=>fetch("".concat(_,"/tgoef/").concat(e.ef_id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.ok?e.json():Promise.reject(e)).then(g),deleteEf:e=>fetch("".concat(_,"/tgoef/").concat(e),{method:"DELETE"}).then(e=>e.ok?e.json():Promise.reject(e)),getCategories:()=>fetch("".concat(_,"/tgoefcategories"),{headers:{"Cache-Control":"no-cache"}}).then(e=>e.ok?e.json():Promise.reject(e)).then(e=>e.map(y)),getSubcategories:()=>fetch("".concat(_,"/tgoefsubcategories"),{headers:{"Cache-Control":"no-cache"}}).then(e=>e.ok?e.json():Promise.reject(e)).then(e=>e.map(v))};var x=()=>{let e={ef_id:0,item:"",item_detail:"",unit:"",ef:"",ef_source_ref:"",tgo_updated:"",tgo_ef_subcat_id:0,created_date:"",updated_date:"",tgo_ef_cat_name:"",tgo_ef_subcat_name:"",tgo_ef_cat_id:0},[t,a]=(0,p.useState)([]),[c,d]=(0,p.useState)(!1),[u,f]=(0,p.useState)(!1),[_,g]=(0,p.useState)(!1),[y,v]=(0,p.useState)(e),[x,j]=(0,p.useState)([]),[w,N]=(0,p.useState)(!1),[C,P]=(0,p.useState)(""),[E,O]=(0,p.useState)(""),[F,S]=(0,p.useState)(!1),[k,z]=(0,p.useState)([]),[R,L]=(0,p.useState)([]),T=(0,p.useRef)(null),I=(0,p.useRef)(null),K=()=>{S(!0),b.getEfs().then(e=>{a(e),S(!1)}).catch(e=>{var t;console.error(e),null===(t=T.current)||void 0===t||t.show({severity:"error",summary:"เกิดข้อผิดพลาด",detail:"ไม่สามารถดึงข้อมูลได้",life:3e3}),S(!1)})};(0,p.useEffect)(()=>{K(),b.getCategories().then(z).catch(console.error),b.getSubcategories().then(L).catch(console.error)},[]);let D=t.filter(e=>e.item.toLowerCase().includes(E.toLowerCase())),H=e=>{v({...e}),d(!0)},B=e=>{v(e),f(!0)},U=async()=>{var e,t;if(x.length){S(!0);try{await Promise.all(x.map(e=>b.deleteEf(e.ef_id))),a(e=>e.filter(e=>!x.includes(e))),null===(e=T.current)||void 0===e||e.show({severity:"success",summary:"สำเร็จ",detail:"ลบรายการที่เลือกแล้ว",life:3e3}),j([]),g(!1)}catch(e){null===(t=T.current)||void 0===t||t.show({severity:"error",summary:"Error",detail:"เกิดข้อผิดพลาด",life:3e3})}finally{S(!1)}}};return(0,o.jsx)("div",{className:"grid",children:(0,o.jsx)("div",{className:"col-12",children:(0,o.jsxs)("div",{className:"card p-4",children:[(0,o.jsx)(r.F,{ref:T}),(0,o.jsxs)("div",{className:"flex flex-column md:flex-row md:justify-content-between md:align-items-center gap-3",children:[(0,o.jsx)("h2",{className:"m-0",children:"ค่าการปล่อยก๊าซเรือนกระจก"}),(0,o.jsxs)("div",{className:"flex flex-column md:flex-row gap-3",children:[(0,o.jsxs)("span",{className:"p-input-icon-left mr-3",children:[(0,o.jsx)("i",{className:"pi pi-search"}),(0,o.jsx)(s.o,{type:"search",placeholder:"ค้นหาด้วยชื่อ...",value:E,onChange:e=>O(e.target.value),className:"w-full"})]}),(0,o.jsx)(n.z,{label:"เพิ่มค่าการปล่อยก๊าซเรือนกระจก",icon:"pi pi-plus",severity:"success",onClick:()=>{v(e),N(!1),d(!0)}})]})]}),(0,o.jsxs)(l.w,{ref:I,value:D,selection:x,onSelectionChange:e=>j(e.value),dataKey:"ef_id",selectionMode:"multiple",paginator:!0,rows:10,rowsPerPageOptions:[5,10,25],className:"datatable-responsive mt-4",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"แสดง {first} ถึง {last} จากทั้งหมด {totalRecords} รายการ",globalFilter:C,emptyMessage:"ไม่พบข้อมูล",loading:F,responsiveLayout:"scroll",header:x&&x.length>0?(0,o.jsxs)("div",{className:"flex justify-content-between align-items-center",children:[(0,o.jsx)("span",{children:"เลือก ".concat(x.length," รายการ")}),(0,o.jsx)(n.z,{label:"ลบที่เลือก",icon:"pi pi-trash",severity:"danger",onClick:()=>g(!0)})]}):null,children:[(0,o.jsx)(i.s,{selectionMode:"multiple",headerStyle:{width:"3rem"}}),(0,o.jsx)(i.s,{field:"index",header:"ลำดับ",body:(e,t)=>{let{rowIndex:a}=t;return a+1},style:{width:"80px"}}),(0,o.jsx)(i.s,{field:"item",header:"รายการ EF",sortable:!0,style:{width:"250px"}}),(0,o.jsx)(i.s,{field:"unit",header:"หน่วย",sortable:!0,style:{width:"100px"}}),(0,o.jsx)(i.s,{field:"ef",header:"ค่า EF",sortable:!0,style:{width:"100px"}}),(0,o.jsx)(i.s,{field:"tgo_ef_cat_name",header:"หมวดหมู่",sortable:!0,style:{width:"100px"}}),(0,o.jsx)(i.s,{field:"tgo_ef_subcat_name",header:"หมวดย่อย",sortable:!0,style:{width:"150px"}}),(0,o.jsx)(i.s,{body:e=>(0,o.jsxs)("div",{className:"flex gap-1",children:[(0,o.jsx)(n.z,{icon:"pi pi-pencil",rounded:!0,severity:"success",onClick:()=>H(e),tooltip:"แก้ไข",tooltipOptions:{position:"top"}}),(0,o.jsx)(n.z,{icon:"pi pi-trash",rounded:!0,severity:"danger",onClick:()=>B(e),tooltip:"ลบ",tooltipOptions:{position:"top"}})]}),header:"การดำเนินการ",headerStyle:{width:"140px"},bodyStyle:{textAlign:"center"}})]}),(0,o.jsx)(m,{visible:c,ef:y,submitted:w,onHide:()=>{N(!1),d(!1)},onChange:(e,t)=>{v({...y,[t]:e.target.value})},onSave:()=>{N(!0),y.item.trim()&&(S(!0),y.ef_id?b.updateEf(y).then(t=>{var o;a(e=>e.map(e=>e.ef_id===t.ef_id?t:e)),null===(o=T.current)||void 0===o||o.show({severity:"success",summary:"สำเร็จ",detail:"อัพเดต EF แล้ว",life:3e3}),K(),d(!1),v(e)}).catch(e=>{var t;console.error(e),null===(t=T.current)||void 0===t||t.show({severity:"error",summary:"เกิดข้อผิดพลาด",detail:"อัพเดต EF ไม่สำเร็จ",life:3e3})}).finally(()=>S(!1)):b.createEf(y).then(t=>{var o;a(e=>[...e,t]),null===(o=T.current)||void 0===o||o.show({severity:"success",summary:"สำเร็จ",detail:"เพิ่ม EF แล้ว",life:3e3}),d(!1),v(e)}).catch(e=>{var t;console.error(e),null===(t=T.current)||void 0===t||t.show({severity:"error",summary:"เกิดข้อผิดพลาด",detail:"เพิ่ม EF ไม่สำเร็จ",life:3e3})}).finally(()=>S(!1)))},tgoCategories:k,tgoSubcategories:R,onCategoryChange:e=>{v({...y,tgo_ef_cat_id:e.value,tgo_ef_subcat_id:0})},onSubcategoryChange:e=>{v({...y,tgo_ef_subcat_id:e.value})}}),(0,o.jsx)(h.Z,{visible:u,onHide:()=>f(!1),onConfirm:()=>{S(!0),b.deleteEf(y.ef_id).then(()=>{var t;a(e=>e.filter(e=>e.ef_id!==y.ef_id)),f(!1),v(e),null===(t=T.current)||void 0===t||t.show({severity:"success",summary:"สำเร็จ",detail:"ลบ EF แล้ว",life:3e3})}).catch(e=>{var t;console.error(e),null===(t=T.current)||void 0===t||t.show({severity:"error",summary:"เกิดข้อผิดพลาด",detail:"ลบ EF ไม่สำเร็จ",life:3e3})}).finally(()=>S(!1))},message:"คุณแน่ใจหรือไม่ว่าต้องการลบ ".concat(y.item,"?")}),(0,o.jsx)(h.Z,{visible:_,onHide:()=>g(!1),onConfirm:U,message:"คุณแน่ใจหรือไม่ว่าต้องการลบ {selectedEfs.length} รายการที่เลือก?"})]})})})}},4631:function(e,t,a){a.d(t,{g:function(){return m}});var o=a(6006),n=a(3142),i=a(6878),l=a(5497),s=a(9424),r=a(5942);function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e}).apply(this,arguments)}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u=i.V.extend({defaultProps:{__TYPE:"InputTextarea",__parentMetadata:null,autoResize:!1,keyfilter:null,onBlur:null,onFocus:null,onBeforeInput:null,onInput:null,onKeyDown:null,onKeyUp:null,onPaste:null,tooltip:null,tooltipOptions:null,validateOnly:!1,children:void 0},css:{classes:{root:function(e){var t=e.props,a=e.isFilled;return(0,r.AK)("p-inputtextarea p-inputtext p-component",{"p-disabled":t.disabled,"p-filled":a,"p-inputtextarea-resizable":t.autoResize},t.className)}},styles:"\n@layer primereact {\n    .p-inputtextarea-resizable {\n        overflow: hidden;\n        resize: none;\n    }\n    \n    .p-fluid .p-inputtextarea {\n        width: 100%;\n    }\n}\n"}});function f(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,o)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?f(Object(a),!0).forEach(function(t){!function(e,t,a){var o;o=function(e,t){if("object"!==d(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var o=a.call(e,t||"default");if("object"!==d(o))return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"===d(o)?o:String(o))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var m=o.memo(o.forwardRef(function(e,t){var a=o.useContext(n.Ou),d=u.getProps(e,a),f=o.useRef(t),m=o.useRef(0),h=u.setMetaData(p(p({props:d},d.__parentMetadata),{},{context:{disabled:d.disabled}})),_=h.ptm,g=h.cx,y=h.isUnstyled;(0,i.e)(u.css.styles,y,{name:"inputtextarea"});var v=function(e){var t=f.current;t&&r.p7.isVisible(t)&&(m.current||(m.current=t.scrollHeight,t.style.overflow="hidden"),(m.current!==t.scrollHeight||e)&&(t.style.height="",t.style.height=t.scrollHeight+"px",parseFloat(t.style.height)>=parseFloat(t.style.maxHeight)?(t.style.overflowY="scroll",t.style.height=t.style.maxHeight):t.style.overflow="hidden",m.current=t.scrollHeight))};o.useEffect(function(){r.gb.combinedRefs(f,t)},[f,t]),o.useEffect(function(){d.autoResize&&v(!0)},[d.autoResize]);var b=o.useMemo(function(){return r.gb.isNotEmpty(d.value)||r.gb.isNotEmpty(d.defaultValue)},[d.value,d.defaultValue]),x=r.gb.isNotEmpty(d.tooltip),j=(0,r.dG)({ref:f,className:g("root",{isFilled:b}),onFocus:function(e){d.autoResize&&v(),d.onFocus&&d.onFocus(e)},onBlur:function(e){d.autoResize&&v(),d.onBlur&&d.onBlur(e)},onKeyUp:function(e){d.autoResize&&v(),d.onKeyUp&&d.onKeyUp(e)},onKeyDown:function(e){d.onKeyDown&&d.onKeyDown(e),d.keyfilter&&l.F.onKeyPress(e,d.keyfilter,d.validateOnly)},onBeforeInput:function(e){d.onBeforeInput&&d.onBeforeInput(e),d.keyfilter&&l.F.onBeforeInput(e,d.keyfilter,d.validateOnly)},onInput:function(e){var t=e.target;d.autoResize&&v(r.gb.isEmpty(t.value)),d.onInput&&d.onInput(e),r.gb.isNotEmpty(t.value)?r.p7.addClass(t,"p-filled"):r.p7.removeClass(t,"p-filled")},onPaste:function(e){d.onPaste&&d.onPaste(e),d.keyfilter&&l.F.onPaste(e,d.keyfilter,d.validateOnly)}},u.getOtherProps(d),_("root"));return o.createElement(o.Fragment,null,o.createElement("textarea",j),x&&o.createElement(s.u,c({target:f,content:d.tooltip},d.tooltipOptions,{pt:_("tooltip")})))}));m.displayName="InputTextarea"}}]);